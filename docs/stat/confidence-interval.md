# 추정과 신뢰구간

## 모집단과 표본 (Population & Sample)

*   **모집단 (Population):** 연구 관심 대상이 되는 **집단 전체**.
*   **표본 (Sample):** 특정 연구에서 선택된 모집단의 **부분 집합**.
*   **표집 (Sampling) / 표본 추출:** 모집단에서 표본 추출하는 절차.
*   **필요성:** 대부분 경우 집단 전체 **전수조사 어려움**. 무작위 표본 추출하여 모집단 대해 **추론**.

*(슬라이드 63 그림 참고)*

## 모수 (Population Parameter)

*   **파라미터 (Parameter):** 어떤 시스템 특성 나타내는 값.
*   **모수:** **모집단(Population)**의 파라미터 → **모집단 특성** 나타내는 값.
*   **예시:** 모집단 평균 (모평균), 모집단 분산 (모분산).
*   **특징:** 구하려면 전수조사 필요 (사실상 어려움).
*   **주의:** "표본 크기"를 "모수"라고 하는 경우 있으나 잘못된 표현.

## 통계량 (Sample Statistic)

*   **표본**에서 얻어진 수로 계산한 값 (=통계치).
*   **예시:** 표본 평균, 표본 분산.
*   **주의:**
    *   "모집단의 통계량" 표현 없음 (통계량은 표본에서 구함).
    *   "표본의 모수" 표현 없음 (모수는 모집단에서 구함).
*   **추론 통계 (Inferential Statistics):** 표본 통계량 일반화하여 **모집단 대해 추론**하는 것.

## 추정 (Estimation)

*   **통계량**으로부터 **모수**를 추측하는 절차.
*   **점 추정 (Point Estimate):** **하나의 수치**로 모수 추정.
*   **구간 추정 (Interval Estimate):** **구간**으로 모수 추정 (예: 신뢰구간).

## 추정 과정 요약

*(슬라이드 67 그림 참고)*
모집단 → (표집) → 표본 → (계산) → 통계량 → (추정) → 모수
(모집단 특성 = 모수)

## 표집 오차 (Sampling Error)

*   **모집단과 표본 다르기 때문**에 생기는, 표본 추정값과 실제 모수와의 **차이**.
*   **예시:**
    *   모집단 (6면체 주사위) 평균 = 3.5
    *   표본 (주사위 10개 굴림, 합 26) 평균 = 2.6
    *   표집 오차 = 2.6 - 3.5 = -0.9

## 오차 범위 (Margin of Error)

*   표집 오차가 발생할 수 있는 **범위**.
*   **예시:** 6면체 주사위 표집 오차는 아무리 커도 ±2.5 넘을 수 없음 (최소 평균 1, 최대 평균 6이므로).
*   **영향 요소:**
    *   **신뢰수준 (Confidence Level):** 얼마나 극단적 경우까지 포함할 것인가?
    *   **표본 크기 (Sample Size):** 표본에 얼마나 많은 사례 포함할 것인가?
    *   **모집단 변산성 (Population Variability):** 모집단 데이터 퍼짐 정도 얼마나 큰가?

## 신뢰수준 (Confidence Level)

*   모수가 특정 구간 안에 포함될 것이라고 **믿는(기대하는) 정도**. 통계적 추정의 **확실성 수준**.
*   **극단값 포함:** 극단적 경우(우연히 발생 확률 낮은 값) 포함하면 오차 범위 커짐.
*   **극단값 배제:** 극단적 경우 배제하면 오차 범위 줄일 수 있음.
*   **유의수준 (Significance Level, α):** **배제하는** 극단적 경우의 비율 (보통 5% = 0.05).
*   **신뢰수준 = 100% - 유의수준**. (예: 유의수준 5% → 신뢰수준 95%). 오차 범위 계산 시 **고려하는 비율**.
*   **신뢰수준과 오차범위 관계:**
    *   **높은 신뢰수준** (예: 99%) → 더 많은 가능성(극단값) 포함 → **넓은 오차범위**.
    *   **낮은 신뢰수준** (예: 90%) → 더 적은 가능성 포함 → **좁은 오차범위**.
*   **주의:** "신뢰"라는 단어 때문에 **일상적 의미와 혼동**하기 쉬움. 단순히 오차 범위 계산 시 적용하는 확률 기준임.

*(슬라이드 70 그림 참고)*
*   신뢰수준 95% 경우 오차 범위 < 신뢰수준 99% 경우 오차 범위

## 신뢰 수준 100%면 안되는 이유

*   신뢰 수준 100%는 모든 가능성을 포함해야 함. 이는 "범인은 20~50대 남자 혹은 여자", "도주 경로는 전국 또는 해외" 와 같이 **아무 정보도 주지 못하는 무의미한 추정**이 됨.

## 신뢰 수준의 결정

*   **타협 필요:** 절대적 기준 없음. 적절한 수준에서 결정.
*   **너무 높으면 (예: 99.9%):** 가능성 희박한 극단 경우 너무 많이 고려 → 오차 범위 너무 넓어져 **의사결정 불가**.
*   **너무 낮으면 (예: 80%):** 발생 가능한 경우 너무 많이 배제 → 오차 범위 좁지만, 실제 모수 포함 못 할 위험 커져 **추정 타당성 떨어짐**.
*   **관례적 기준:** 교과서 등에서 95%, 99% 등을 추천하나, 분야나 문제 상황 따라 다르게 적용 가능.

## 데이터의 변산성 (Variability)

*   데이터 퍼짐 정도 클수록 (변산성 크면) 오차 범위 커짐.
*   **예시:**
    *   6면체 주사위(값 1~6) vs 20면체 주사위(값 1~20). 둘 다 기대값 비슷하게 조정 가능해도, 20면체 쪽 변산성 훨씬 커서 **오차 범위 훨씬 큼**. (20면체 10개 굴려 모두 8이하 나올 가능성 > 6면체 10개 굴려 모두 1 나올 가능성)
*   **개선:** 실험/측정 정확히 하여 변산성 낮추면 오차 범위 작아짐.
*   **한계:** 데이터에 내재한 **본질적 변산성**은 없앨 수 없음.

## 표본의 크기 (Sample Size)

*   **표본 크기 크면 오차 범위 작아짐**.
*   **예시:** 주사위 10개 굴리기(10d6) vs 50개 굴리기(50d6). 50개 굴릴 때 평균이 실제 평균(3.5)에 더 가까울 확률 높음.
*   **무한히 던지면:** 평균은 정확히 3.5 수렴 (오차 범위 0).
*   **통계 문제 해결 핵심:** 데이터 더 모아 **표본 크기 키우는 것** (Big Data!).
*   **단점:** 시간, 비용 증가.

## 신뢰구간 (Confidence Interval, CI)

*   대표적 **구간 추정** 방법.
*   **계산:** `신뢰구간 = 통계량 ± 오차범위`
*   **오차 범위:** 신뢰수준, 표본 크기, 데이터 변산성 등 고려하여 **이론적으로 유도**하여 사용.

## 평균의 신뢰구간

*   모든 통계량(중간값, 비율 등)에 신뢰구간 존재.
*   특히 **평균**의 경우, 이론적으로 신뢰구간 **간단히(정규분포/t-분포 이용) 구할 수 있음**.
*   **예시: 평균의 95% 신뢰구간 계산 (pingouin 패키지 사용)**
    ```python
    import pingouin as pg

    # df.price 데이터의 평균이 0과 다른지 t-검정 수행 (겸사겸사 신뢰구간 계산)
    # 여기서는 모평균이 0이라는 가설 검정 자체보다 신뢰구간 값에 주목
    pg.ttest(df.price, 0, confidence=0.95)
    ```
    *   결과 표에서 `CI95%` 항목 확인 (예: `[814.1, 893.22]`)
    *   해석: df.price의 모평균은 95% 신뢰수준에서 814.1 ~ 893.22 사이에 있을 것으로 추정됨.

## 부트스트래핑 (Bootstrapping)

*   평균과 달리 **중간값, 최빈값 등** 다른 통계량은 오차 범위 이론적 유도 어려움.
*   **대안:** 표본 충분히 크면, **컴퓨터 시뮬레이션(재표집)** 통해 신뢰구간 추정 가능 → 이것이 **부트스트래핑**.
*   **예시: 중간값의 95% 신뢰구간 계산 (scipy 활용)**
    ```python
    import numpy as np
    import scipy.stats as sp # scipy 통계 기능 사용

    # 부트스트래핑 실행
    res = sp.bootstrap(
        [df.price],              # 데이터
        np.median,               # 계산할 통계량 (중간값)
        n_resamples=10000,       # 시뮬레이션(재표집) 횟수
        confidence_level=0.95    # 신뢰수준
    )

    print(res.confidence_interval) # 신뢰구간 결과 출력
    ```
    *   결과 예시: `ConfidenceInterval(low=770.0, high=865.0)`
    *   해석: 중간값의 95% 신뢰구간은 약 770 ~ 865 추정.
    *   **특징:** 시뮬레이션 기반이므로 실행할 때마다 결과 조금씩 달라질 수 있음.

## 여론조사의 "표본오차" 항목

*   국내 여론조사 결과 발표 시 "**표본오차**"라는 이름으로 **오차 범위** 표시.
*   **계산 근거:** 중심극한정리(CLT)에 따라, 보통 **95% 신뢰수준**에서 오차 범위 계산.
$$
\pm 1.96 * \frac{\sqrt{p*(1-p)}}{N} = \pm 1.96 * \frac{50\%}{N} 
$$
*   **계수 의미:**
    *   **1.96:** 신뢰수준 95% 해당 값 (정규분포 기준. 99%면 약 2.58).
    *   **50:** 보통 응답 비율 50%(찬반 등)일 때 변산성(오차) 가장 크므로, 이를 기준 계산.
    *   **N:** 설문 응답자 수.
*   **활용:** 원하는 오차 범위 목표 시, 필요한 **설문 응답자 수 역산** 가능.
    *   예: ±10% 오차 범위 목표 → 약 100명 필요.
    *   표본 크기 4배 늘리면 오차 범위 1/2로 줄어듦 (√N에 반비례).

## 퀴즈

<iframe src="https://tally.so/embed/wvzlJ0?alignLeft=1&hideTitle=1&transparentBackground=1&dynamicHeight=1" loading="lazy" width="100%" height="2105" frameborder="0" marginheight="0" marginwidth="0" title="[통계] 추정과 신뢰구간"></iframe>