# 회귀분석

## 통계에서 예측의 의미

*   **예측 (Prediction) 정의:** 특정 값(보통 종속변수)에 대한 **추론** 의미. 반드시 미래 시점 예측 의미 아님.
*   **지도학습 (Supervised Learning) 관점:** 변수 간 패턴 파악하여, 한 변수(독립변수)로 다른 변수(종속변수) **추론**하는 것.
*   **미래 예측:** 시계열 분석 등에서 미래 값 예측은 보통 **forecasting**이라 구분함.

## 회귀분석 기본

*   **목적:** **독립변수(들)** 이용하여 **연속형 종속변수** 예측/설명하는 분석.
*   **평가:** 예측값과 실제값 차이(잔차) 이용하여 정확성 계산.
*   **독립변수 (Independent Variable, x):** 예측의 바탕 정보, 원인, 입력값. 설명변수, 예측변수라고도 함.
*   **종속변수 (Dependent Variable, y):** 예측 대상, 결과, 출력값. 반응변수라고도 함.

## 선형 모형 (Linear Model)

*   가장 기본적인 회귀 모형. 독립변수와 종속변수 간 직선 관계 가정.
*   **수식:**
    $$ y = wx + b + e$$
*   **구성:**
    *   $\hat{y}$: $y$의 **예측치**.
    *   $x$: **독립변수**.
    *   $w$: **가중치(weight)** 또는 **기울기(slope)**. $x$가 1단위 변할 때 $\hat{y}$의 변화량. 회귀계수(regression coefficient).
    *   $b$: **절편(intercept)**. $x = 0$ 일 때 $y$의 예측치.
    *   $e$: 예측 오차

## 회귀분석 예시: 피부암 사망률

*   독립변수(x): 위도 (Latitude)
*   종속변수(y): 인구 천만명 당 피부암 사망자 수 (Mortality)
*   **분석 결과 (예시):** $\hat{y} = 389.2 - 5.98x$
    *   위도가 1단위 증가할수록 사망률 약 5.98 감소 예측.

## 잔차 (Residual)

*   **정의:** 실제값($y$) - 예측값($\hat{y}$). 예측 오차.
*   **잔차 분산 (Residual Variance / Mean Squared Error, MSE):** 잔차 제곱의 평균. 모형 예측 정확도 지표.
*   **cf. 분산 (Variance):** 편차(실제값 - 평균) 제곱의 평균. 데이터 퍼짐 정도.
*   **해석:**
    *   잔차 분산 크다 → 예측 잘 맞지 않음 (오차 큼).
    *   잔차 분산 작다 → 예측 잘 맞음 (오차 작음).

## 최소제곱법 (Ordinary Least Squares, OLS)

*   회귀 모형 계수($w, b$ 등) 추정하는 가장 표준적인 방법.
*   **원리:** **잔차 제곱합 (Sum of Squared Residuals, SSR)** 또는 **잔차 분산 (MSE)**을 **최소화**하는 계수 찾는 것.
*   "최소'제곱'법" 이유: 잔차(오차)의 '제곱'합을 최소화하기 때문.

## 관계식 (Formula) in Python (statsmodels)

*   회귀분석 모형 설정 위한 문법 (R 언어 스타일).
*   **형식:** `종속변수 ~ 독립변수1 + 독립변수2 + ...`
*   **주의:** **종속변수(y)**가 `~` 기호 **왼쪽(먼저)** 나옴.
*   `+` 기호: 해당 독립변수 모형에 **포함** 의미 (산술 덧셈 아님).

## Python 회귀분석 코드 (statsmodels)

```python
# 1. 모듈 가져오기
from statsmodels.formula.api import ols

# 2. 모형 설정 및 분석 수행
# 형식: ols("종속변수 ~ 독립변수", data=데이터프레임).fit()
m = ols("price ~ mileage", data=df).fit()

# 3. 결과 확인
m.summary()
```

## 회귀계수 추정 결과 해석

*   `m.summary()` 결과 표에서 **`coef` (계수 추정치)**, **`P>|t|` (p-value)**, **`[0.025 0.975]` (95% 신뢰구간)** 중요.
*   **Intercept 행:** 절편($b$)에 대한 정보.
    *   `coef`: 추정된 절편 값 (예: 1258.7668). x=0일 때 y 예측치.
*   **독립변수 행 (예: mileage):** 해당 독립변수 기울기($w$)에 대한 정보.
    *   `coef`: 추정된 기울기 값 (예: -0.0052). x가 1단위 증가할 때 y 예측 변화량.
*   **결과 식:** `price = -0.0052 * mileage + 1258.7668`
*   **기타:** `std err`(표준오차), `t`(t값)는 주로 p-value 계산 위한 중간 값. 직접 해석 필요성 낮음.

## 회귀계수의 가설 검정

*   **목적:** 추정된 회귀계수($w$)가 통계적으로 유의미한지(0과 다른지) 판단.
*   **귀무가설 (H₀):** 모집단에서 해당 회귀계수 = 0 (독립변수가 종속변수 설명 못 함).
*   **판단 (p-value 또는 신뢰구간):**

| 가설검정 (p-value)     | 신뢰구간          | 해석                                         |
| :--------------------- | :---------------- | :------------------------------------------- |
| `p ≥ 유의수준 (0.05)` | `- ~ +` (0 포함) | 귀무가설 기각 실패. 계수가 0일 가능성 배제 못 함. |
| `p < 유의수준 (0.05)` | `- ~ -` 또는 `+ ~ +` (0 미포함) | 귀무가설 기각. 계수가 0과 유의하게 다름. |

## Python 예측 수행

```python
import pandas as pd

# 1. 예측할 새로운 독립변수 데이터 만들기 (DataFrame 형태)
new_df = pd.read_excel('new_car.xlsx')

# 2. 학습된 모형(m)으로 예측 수행
m.predict(new_df)
```

## 퀴즈

import { QuizComponent } from "@/components/QuizComponent";

<QuizComponent hypothesis-testing="regression" quizItems={
[
    {
        "item_type": "radio",
        "question": "회귀분석의 주된 목적은 무엇인가요?",
        "options": [
            "데이터를 여러 그룹으로 분류하는 것",
            "데이터의 차원을 축소하는 것",
            "독립변수를 이용하여 연속형 종속변수를 예측하거나 설명하는 것",
            "변수들 간의 단순한 연관성 정도를 파악하는 것"
        ],
        "hint": "회귀분석의 목적은 독립변수를 이용하여 연속형 종속변수를 예측하거나 설명하는 것입니다",
        "solution": "독립변수를 이용하여 연속형 종속변수를 예측하거나 설명하는 것",
    },
    {
        "item_type": "radio",
        "question": "회귀분석에서 선형 모형 y = wx + b + e에서 y가 의미하는 것은 무엇입니까?",
        "options": [
            "종속변수",
            "독립변수",
            "기울기",
            "절편",
            "예측 오차",
            "모형 이름"
        ],
        "hint": "선형 모형에서 y는 예측하고자 하는 종속변수를 의미합니다.",
        "solution": "종속변수"
    },
    {
        "item_type": "radio",
        "question": "회귀분석에서 선형 모형 y = wx + b + e에서 w가 의미하는 것은 무엇입니까?",
        "options": [
            "종속변수",
            "독립변수",
            "기울기",
            "절편",
            "예측 오차",
            "모형 이름"
        ],
        "hint": "회귀 모형에서 w는 독립변수의 기울기를 의미합니다.",
        "solution": "기울기"
    },
    {
        "item_type": "radio",
        "question": "회귀분석에서 선형 모형 y = wx + b + e에서 x가 의미하는 것은 무엇입니까?",
        "options": [
            "종속변수",
            "독립변수",
            "기울기",
            "절편",
            "예측 오차",
            "모형 이름"
        ],
        "hint": "회귀 모형에서 x는 독립변수를 의미합니다.",
        "solution": "독립변수"
    },
    {
        "item_type": "radio",
        "question": "회귀분석에서 선형 모형 y = wx + b + e에서 b가 의미하는 것은 무엇입니까?",
        "options": [
            "종속변수",
            "독립변수",
            "기울기",
            "절편",
            "예측 오차",
            "모형 이름"
        ],
        "hint": "회귀 모형에서 b는 절편을 의미합니다.",
        "solution": "절편"
    },
    {
        "item_type": "radio",
        "question": "회귀분석에서 선형 모형 y = wx + b + e에서 e가 의미하는 것은 무엇입니까?",
        "options": [
            "종속변수",
            "독립변수",
            "기울기",
            "절편",
            "예측 오차",
            "모형 이름"
        ],
        "hint": "회귀 모형에서 e는 예측 오차를 의미합니다.",
        "solution": "예측 오차"
    },
    {
        "item_type": "radio",
        "question": "최소제곱법(Ordinary Least Squares, OLS)은 회귀 모델의 계수를 추정하기 위해 무엇을 최소화하는 것을 목표로 하나요?",
        "options": [
            "결정계수",
            "잔차 분산",
            "사용된 독립변수의 개수",
            "독립변수와 종속변수 간의 상관계수"
        ],
        "hint": "회귀 모형에서 최소제곱법은 잔차의 제곱합을 최소화하는 방법입니다.",
        "solution": "잔차 분산"
    },
    {
        "item_type": "radio",
        "question": "statsmodels 라이브러리에서 ols(\"Mortality ~ Latitude\", data=df)와 같이 모형을 설정할 때, ~ 기호 왼쪽에 오는 변수(Mortality)는 무엇을 의미하나요?",
        "options": [
            "독립변수",
            "종속변수",
            "절편 항",
            "모형 이름"
        ],
        "hint": "관계식은 y ~ f(x)의 형태입니다",
        "solution": "종속변수"
    },
    {
        "item_type": "radio",
        "question": "회귀계수에 대한 가설 검정 결과, 특정 독립변수의 p-value가 0.002 (유의수준 α = 0.05)로 나왔습니다. 이에 대한 올바른 해석은 무엇인가요?",
        "options": [
            "귀무가설(해당 계수=0)을 기각할 수 없다.",
            "해당 독립변수는 종속변수를 설명하는 데 통계적으로 유의미하지 않다.",
            "해당 회귀계수는 0과 통계적으로 유의하게 다르다고 볼 수 있다.",
            "모형의 설명력(R 제곱)이 매우 낮다."
        ],
        "hint": "p-value가 유의수준보다 작으므로 귀무가설을 기각할 수 있습니다.",
        "solution": "해당 회귀계수는 0과 통계적으로 유의하게 다르다고 볼 수 있다."
    },

    {
        "item_type": "radio",
        "question": "회귀분석에서 실제 관측값과 회귀 모형에 의해 예측된 값 사이의 차이를 무엇이라고 하나요?",
        "options": [
            "잔차",
            "오차",
            "편차",
            "차이"
        ],
        "hint": "잔차는 실제값과 예측값의 차이를 의미합니다.",
        "solution": "잔차"
    },

    {
        "item_type": "radio",
        "question": "safety.xlsx에서 length를 독립변수(x)로, risk를 종속변수(y)로 회귀분석을 하려고 합니다. 관계식은 어떻게 세워야 합니까? (힌트: y = f(x))",
        "options": [
            "risk ~ length",
            "length ~ risk"
        ],
        "hint": "관계식은 종속변수 ~ 독립변수의 형태로 세워야 합니다.",
        "solution": "risk ~ length"
    },
    {
        "item_type": "short",
        "question": "length의 기울기(또는 가중치)는 얼마입니까?",
        "options": [],
        "hint": "```\nimport pandas as pd\nfrom statsmodels.formula.api import ols\nsf = pd.read_excel(\'safety.xlsx\')\nols(\'risk ~ length\', data=sf).fit().summary()\n```",
        "solution": "-0.0348"
    },
    {
        "item_type": "radio",
        "question": "위의 기울기에 대한 p-value를 해석해보세요",
        "options": [
            "length는 risk에 통계적으로 유의한 영향이 있다",
            "length는 risk에 통계적으로 유의한 영향이 없다"
        ],
        "hint": "p-value가 유의수준보다 작으면 귀무가설을 기각할 수 있습니다.",
        "solution": "length는 risk에 통계적으로 유의한 영향이 있다"
    }
]
} />


## Q&A
<iframe src="https://tally.so/embed/wbOOKg?alignLeft=1&hideTitle=1&transparentBackground=1&dynamicHeight=0" loading="lazy" width="100%" height="274" frameborder="0" marginheight="0" marginwidth="0" title="Q&A"></iframe>

