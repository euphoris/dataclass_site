# êµì°¨ ê²€ì¦

## êµì°¨ ê²€ì¦ (Cross Validation, CV)

*   **ëª©ì :** ëª¨í˜•ì˜ **ì¼ë°˜í™” ì„±ëŠ¥ (ìƒˆë¡œìš´ ë°ì´í„° ì˜ˆì¸¡ ì„±ëŠ¥)** í‰ê°€ ë°©ë²•.
*   **ì›ë¦¬:** ë°ì´í„°ë¥¼ **í›ˆë ¨(train)ì…‹**ê³¼ **í…ŒìŠ¤íŠ¸(test)ì…‹**ìœ¼ë¡œ ë¶„í• . í›ˆë ¨ì…‹ìœ¼ë¡œ ëª¨í˜• í•™ìŠµ í›„, **ë³„ê°œ í…ŒìŠ¤íŠ¸ì…‹**ìœ¼ë¡œ ì˜ˆì¸¡ ì„±ëŠ¥ ê²€ì¦.
*   **ì¥ì :** ìˆ˜ì •RÂ²/AIC/BIC ë“± ì´ë¡ ì  ë³´ì •ë³´ë‹¤ **ê³¼ì í•© ë” í˜„ì‹¤ì ìœ¼ë¡œ ë°˜ì˜ ê°€ëŠ¥**. ì´ë¡ ì  ê°€ì • ë¶ˆí•„ìš”. ë°ì´í„° ì¶©ë¶„ ì‹œ ê¶Œì¥.
*   **ë‹¨ì :** ë°ì´í„° ë¶„í•  í•„ìš”. ê³„ì‚° ë¹„ìš© ì¦ê°€.

## êµì°¨ ê²€ì¦ ì¢…ë¥˜

*   **ë°ì´í„° ë¶„í• /í™œìš© ë°©ì‹** ë”°ë¼ ì—¬ëŸ¬ ì¢…ë¥˜ ì¡´ì¬.
    *   **LpO CV (Leave-p-out):** pê°œ ì œì™¸í•œ ë°ì´í„°ë¡œ í•™ìŠµ, pê°œë¡œ í…ŒìŠ¤íŠ¸. ëª¨ë“  ì¡°í•© ì‹œë„ (í˜„ì‹¤ì ìœ¼ë¡œ ì–´ë ¤ì›€).
    *   **LOOCV (Leave-one-out):** 1ê°œ ì œì™¸í•œ ë°ì´í„°ë¡œ í•™ìŠµ, 1ê°œë¡œ í…ŒìŠ¤íŠ¸. Në²ˆ ë°˜ë³µ (N=ë°ì´í„° ê°œìˆ˜).
    *   **k-fold CV:** ë°ì´í„° kê°œ ë¬¶ìŒ(fold) ë¶„í• . k-1ê°œë¡œ í•™ìŠµ, 1ê°œë¡œ í…ŒìŠ¤íŠ¸. kë²ˆ ë°˜ë³µí•˜ë©° í…ŒìŠ¤íŠ¸ì…‹ ë³€ê²½. ê°€ì¥ ë„ë¦¬ ì‚¬ìš©.
    *   **Holdout:** ë°ì´í„° í•œ ë²ˆë§Œ í›ˆë ¨/í…ŒìŠ¤íŠ¸ì…‹ ë¶„í• í•˜ì—¬ 1íšŒ ê²€ì¦. ê°€ì¥ ê°„ë‹¨.

## êµì°¨ ê²€ì¦ ê²°ê³¼ í•´ì„

| í›ˆë ¨ ì˜¤ì°¨ | í…ŒìŠ¤íŠ¸ ì˜¤ì°¨ | ìƒíƒœ        | ì¡°ì¹˜                |
| :-------- | :---------- | :---------- | :------------------ |
| ë†’ìŒ      | ë†’ìŒ        | **ê³¼ì†Œì í•©** (Underfitting) | ëª¨í˜• ë³µì¡í•˜ê²Œ ìˆ˜ì •  |
| ë‚®ìŒ      | ë‚®ìŒ        | **ì ì ˆ**    | ë°”ëŒì§              |
| ë‚®ìŒ      | ë†’ìŒ        | **ê³¼ì í•©** (Overfitting)  | ëª¨í˜• ë‹¨ìˆœí•˜ê²Œ ìˆ˜ì •  |

[ğŸ’¾ varsel.py ë‹¤ìš´ë¡œë“œ](https://drive.google.com/file/d/1qSg1QlJKErsROH3w7-ueS0MbYxWCL3eq/view?usp=drive_link)

## Python êµì°¨ ê²€ì¦ ì½”ë“œ

```python
from sklearn.model_selection import train_test_split
from sklearn.metrics import mean_squared_error

# 1. ë°ì´í„° ë¶„í•  (80% í›ˆë ¨, 20% í…ŒìŠ¤íŠ¸)
train_df, test_df = train_test_split(
    df,               # ì›ë³¸ ë°ì´í„°
    test_size=0.2,    # í…ŒìŠ¤íŠ¸ ë°ì´í„° ë¹„ìœ¨
    random_state=42   # ë‚œìˆ˜ ì‹œë“œ ê³ ì • (ì¬í˜„ì„± ìœ„í•¨)
)

# 2. í›ˆë ¨ ë°ì´í„°ë¡œ ëª¨í˜• í•™ìŠµ
m = ols('price ~ year', data=train_df).fit()

# 3. í…ŒìŠ¤íŠ¸ ë°ì´í„°ë¡œ ì˜ˆì¸¡
y_pred = m.predict(test_df)

# 4. í…ŒìŠ¤íŠ¸ ë°ì´í„° ì˜ˆì¸¡ ì˜¤ì°¨(MSE) ê³„ì‚°
mean_squared_error(test_df.price, y_pred)
```

## ì „ì§„ ì„ íƒ

```python
ì „ì§„ ì„ íƒ
m = varsel.forward_selection_with_cv(
    'price ~ year + mileage + model + my_car_damage + other_car_damage', 
    train_df, test_df)
m.summary()      
```

## í›„ì§„ ì„ íƒ

```python

í›„ì§„ ì„ íƒ
m = varsel.backward_selection_with_cv(
    'price ~ year + mileage + model + my_car_damage + other_car_damage', 
    train_df, test_df)
m.summary()    
```


## í€´ì¦ˆ

import { QuizComponent } from "@/components/QuizComponent";

<QuizComponent quizId="cross-validation" quizItems={
[
    {
        "item_type": "radio",
        "question": "êµì°¨ ê²€ì¦(Cross Validation)ì„ ìˆ˜í–‰í•˜ëŠ” ì£¼ëœ ëª©ì ì€ ë¬´ì—‡ì¸ê°€ìš”?",
        "options": [
            "íšŒê·€ê³„ìˆ˜ì˜ ì‹ ë¢°êµ¬ê°„ì„ ë” ì¢ê²Œ ì¶”ì •í•˜ê¸° ìœ„í•´",
            "ë…ë¦½ë³€ìˆ˜ë“¤ ê°„ì˜ ë‹¤ì¤‘ê³µì„ ì„± ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´",
            "ëª¨í˜•ì´ ìƒˆë¡œìš´ ë°ì´í„°ì— ëŒ€í•´ ì–¼ë§ˆë‚˜ ì˜ ì˜ˆì¸¡í• ì§€(ì¼ë°˜í™” ì„±ëŠ¥)ë¥¼ í‰ê°€í•˜ê¸° ìœ„í•´",
            "ì¢…ì†ë³€ìˆ˜ì˜ ë¶„í¬ë¥¼ ì •ê·œë¶„í¬ì— ê°€ê¹ê²Œ ë³€í™˜í•˜ê¸° ìœ„í•´"
        ],
        "hint": "êµì°¨ ê²€ì¦ì€ ì¶”ì •ëœ ëª¨í˜•ì„ ìƒˆë¡œìš´ ë°ì´í„°ì— ì ìš©í•˜ì—¬ ì˜ˆì¸¡ ì„±ëŠ¥ì„ í‰ê°€í•˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤.",
        "solution": "ëª¨í˜•ì´ ìƒˆë¡œìš´ ë°ì´í„°ì— ëŒ€í•´ ì–¼ë§ˆë‚˜ ì˜ ì˜ˆì¸¡í• ì§€(ì¼ë°˜í™” ì„±ëŠ¥)ë¥¼ í‰ê°€í•˜ê¸° ìœ„í•´",
    },
    {
        "item_type": "radio",
        "question": "ë°ì´í„°ë¥¼ ê°™ì€ í¬ê¸°ì˜ ì—¬ëŸ¬ ë¶€ë¶„ìœ¼ë¡œ ë‚˜ëˆ„ì–´, ê° ë¶€ë¶„ì„ í•œ ë²ˆì”© í…ŒìŠ¤íŠ¸ì…‹ìœ¼ë¡œ ì‚¬ìš©í•˜ê³  ë‚˜ë¨¸ì§€ë¥¼ í›ˆë ¨ì…‹ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” êµì°¨ ê²€ì¦ ë°©ë²•ì€ ë¬´ì—‡ì¸ê°€ìš”?",
        "options": [
            "Holdout êµì°¨ ê²€ì¦",
            "Leave-One-Out êµì°¨ ê²€ì¦ (LOOCV)",
            "k-í´ë“œ êµì°¨ ê²€ì¦ (k-fold CV)",
            "Leave-p-Out êµì°¨ ê²€ì¦ (LpO CV)"
        ],
        "hint": "k-í´ë“œ êµì°¨ ê²€ì¦ì€ ë°ì´í„°ë¥¼ kê°œì˜ ë¶€ë¶„ìœ¼ë¡œ ë‚˜ëˆ„ì–´, ê° ë¶€ë¶„ì„ í•œ ë²ˆì”© í…ŒìŠ¤íŠ¸ì…‹ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤.",
        "solution": "k-í´ë“œ êµì°¨ ê²€ì¦ (k-fold CV)"
    },
    {
        "item_type": "radio",
        "question": "êµì°¨ ê²€ì¦ ê²°ê³¼, í›ˆë ¨ ë°ì´í„°ì— ëŒ€í•œ ì˜¤ì°¨ëŠ” ë§¤ìš° ë‚®ì•˜ì§€ë§Œ í…ŒìŠ¤íŠ¸ ë°ì´í„°ì— ëŒ€í•œ ì˜¤ì°¨ëŠ” ë§¤ìš° ë†’ê²Œ ë‚˜ì™”ìŠµë‹ˆë‹¤. ì´ ëª¨í˜•ì˜ ìƒíƒœë¥¼ ê°€ì¥ ì˜ ì„¤ëª…í•˜ëŠ” ê²ƒì€ ë¬´ì—‡ì¸ê°€ìš”?",
        "options": [
            "ê³¼ì†Œì í•© (Underfitting) ìƒíƒœì´ë©°, ëª¨í˜•ì„ ë” ë³µì¡í•˜ê²Œ ë§Œë“¤ì–´ì•¼ í•œë‹¤.",
            "ê³¼ëŒ€ì í•© (Overfitting) ìƒíƒœì´ë©°, ëª¨í˜•ì„ ë” ë‹¨ìˆœí•˜ê²Œ ë§Œë“¤ì–´ì•¼ í•œë‹¤.",
            "ì ì ˆí•œ ìƒíƒœì´ë©°, ì´ ëª¨í˜•ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ë°”ëŒì§í•˜ë‹¤.",
            "í›ˆë ¨ ë°ì´í„°ì™€ í…ŒìŠ¤íŠ¸ ë°ì´í„°ê°€ ì˜ëª» ë¶„ë¦¬ë˜ì—ˆìœ¼ë¯€ë¡œ ë°ì´í„°ë¥¼ ë‹¤ì‹œ ë¶„í• í•´ì•¼ í•œë‹¤.",
        ],
        "hint": "í›ˆë ¨ ë°ì´í„°ì— ëŒ€í•œ ì˜¤ì°¨ê°€ ë‚®ê³  í…ŒìŠ¤íŠ¸ ë°ì´í„°ì— ëŒ€í•œ ì˜¤ì°¨ê°€ ë†’ë‹¤ëŠ” ê²ƒì€ ëª¨í˜•ì´ í›ˆë ¨ ë°ì´í„°ì— ë„ˆë¬´ ê³¼í•˜ê²Œ ì í•©ë˜ì–´ ìƒˆë¡œìš´ ë°ì´í„°ì— ëŒ€í•œ ì˜ˆì¸¡ ì„±ëŠ¥ì´ ë–¨ì–´ì§€ëŠ” ê³¼ëŒ€ì í•© ìƒíƒœë¥¼ ì˜ë¯¸í•©ë‹ˆë‹¤.",
        "solution": "ê³¼ëŒ€ì í•© (Overfitting) ìƒíƒœì´ë©°, ëª¨í˜•ì„ ë” ë‹¨ìˆœí•˜ê²Œ ë§Œë“¤ì–´ì•¼ í•œë‹¤."
    },
    {
        "item_type": "checkbox",
        "question": "call_center.xlsx ì—ì„œ salesë¥¼ ì¢…ì†ë³€ìˆ˜ë¡œ íšŒê·€ë¶„ì„ì„ ìˆ˜í–‰í•˜ì„¸ìš”. êµì°¨ ê²€ì¦ê³¼ ì „ì§„ì„ íƒì„ í†µí•´ ëª¨í˜•ì„ ì„ íƒí•˜ì„¸ìš”. ì´ë•Œ ì „ì§„ì„ íƒì—ì„œ ì¶”ê°€ëœ ë³€ìˆ˜ë“¤ì„ **ëª¨ë‘** ê³ ë¥´ì„¸ìš”",
        "options": [
            "kind",
            "active",
            "talk",
            "career",
            "gender"
        ],
        "hint": "```\nimport pandas as pd\nimport varsel\nfrom sklearn.model_selection import train_test_split\ncc = pd.read_excel(\'call_center.xlsx\')\n\ntrain_df, test_df = train_test_split(\n    cc,               # ì›ë³¸ ë°ì´í„°\n    test_size=0.2,    # í…ŒìŠ¤íŠ¸ ë°ì´í„° ë¹„ìœ¨\n    random_state=42   # ë‚œìˆ˜ ì‹œë“œ ê³ ì • (ì¬í˜„ì„± ìœ„í•¨)\n)\nm = varsel.forward_selection_with_cv(\'sales ~ kind + active + talk + career + gender\', train_df, test_df)\nm.summary()\n```",
        "solution": [
            "active",
            "talk",
        ],
    },
    {
        "item_type": "number",
        "question": "ìœ„ì—ì„œ ì„ íƒëœ ëª¨í˜•ì˜ í…ŒìŠ¤íŠ¸ MSEëŠ” ì–¼ë§ˆì…ë‹ˆê¹Œ? (ì†Œìˆ˜ì  ë‘˜ì§¸ ìë¦¬ê¹Œì§€)",
        "tolerance": 0.01,
        "hint": "ìœ„ì˜ ë¬¸ì œ íŒíŠ¸ ì°¸ê³ ",
        "solution": 388.0131371861462
    },
    {
        "item_type": "radio",
        "question": "call_center.xlsx ì—ì„œ salesë¥¼ ì¢…ì†ë³€ìˆ˜ë¡œ íšŒê·€ë¶„ì„ì„ ìˆ˜í–‰í•˜ì„¸ìš”. êµì°¨ ê²€ì¦ê³¼ í›„ì§„ì„ íƒì„ í†µí•´ ëª¨í˜•ì„ ì„ íƒí•˜ì„¸ìš”. ì´ë•Œ **ì œì¼ ë¨¼ì €** ì œê±°ëœ ë…ë¦½ë³€ìˆ˜ë¥¼ ê³ ë¥´ì„¸ìš”",
        "options": [
            "kind",
            "active",
            "talk",
            "career",
            "gender"
        ],
        "hint": "```\nm = varsel.backward_selection_with_cv(\'sales ~ kind + active + talk + career + gender\', train_df, test_df)\nm.summary()\n```",
        "solution": "kind"
    }
]
} />

## Q&A
<iframe src="https://tally.so/embed/wbOOKg?alignLeft=1&hideTitle=1&transparentBackground=1&dynamicHeight=0" loading="lazy" width="100%" height="274" frameborder="0" marginheight="0" marginwidth="0" title="Q&A"></iframe>