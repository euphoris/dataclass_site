
## 회귀분석 임포트


```python
from statsmodels.formula.api import ols
```


파이선에서 선형회귀 분석은 `statsmodels`라는 모듈을 써요.

우리 회사도 보면 회사는 다시 부서가 있고 부서 안에 또 작은 팀들이 있고 이런 경우 있잖아요.

마찬가지로 `statsmodels`라는 모듈 안에는 `formula`라는 모듈이 있고 `formula` 모듈 안에 `api` 모듈이 있습니다.

여기에서 `from` 어디 어디에서 이런 거죠, 여기에서 임포트를 해와라, 뭘 임포트 해오냐면 `ols`라는 함수를 임포트 해와라, 이런 얘기입니다.



## 분석 


우리가 이제 중고차 가격을 한번 분석을 해볼 건데 여기 보시면 가격이 있고요. 그 다음에 맨 왼쪽에 보시면 `mileage`라고 있어요. `mileage`가 이제 주행거리거든요. 그러니까 첫 번째 차는 63,608km 띈 K3인데 시장의 가격이 970만 원에 거래가 됐습니다.

요 `ols`라는 함수는 선형 회귀분석을 하게 해주는 그런 함수입니다. 이 `ols`라는 함수한테 우리가 두 가지를 주면 돼요.

```python
m = ols("price ~ mileage", data = df).fit()
```

### 관계식

관계식은 뭐냐면 그래서 독립변수가 뭐고 종속변수가 뭐냐.

종속변수($y$): `price`를 왼쪽에 써줍니다.

그리고 가격이 뭐에 따라서 달라지냐 물결 표시 `~`는 뭐에 따라서 달라진다, 이런 뜻이고

뭐에 따라 달라지냐면 독립변수($x$): `mileage` 주행거리에 따라서 달라진다

이게 관계식이에요. 이 식에 따라서 분석을 해라. 이런 뜻이고요. 이 앞뒤로도 따옴표를 붙여줍니다.

굵은 따옴표를 했는데 따옴표는 작은 따옴표로 하셔도 되고 큰 따옴표로 하셔도 돼요. 아무거나 하시면 되는데 짝만 맞으면 됩니다.

### 데이터

그 다음에 `data=df` 이렇게 써 놨는데 이거는 무슨 데이터로 분석을 할 거냐 `df`에 있는 데이터로 분석을 할 거다, 이런 얘기입니다.

여기 `data`는 변수는 아니고 그냥 이 ols란 함수가 받을 수 있는 인자가 여러 개가 있어요. 그 중에 데이터부분은 df로 설정해라. 그럼 우리가 지정을 안 해 준 거는 기본값으로 지정을 해 주게 됩니다.

### fit

뒤에 보시면 `.fit()`이라고 있는데 이거는 이제 뭐냐면 요 앞에는 이제 분석을 세팅을 한 거고 이 fit은 맞춰라 이런 뜻입니다. 데이터에 맞춰서 실제로 분석을 하라는 뜻입니다.

그래서 fit이 우리가 아 옷이 fit이 좋아 옷이 내 몸에 딱 맞는다 이런 얘기잖아요. 그래서 fit이 데이터에 맞춰서 분석을 수행을 해라 이런 뜻입니다.

그러면 그 분석 결과가 `m`이라는 변수에 들어가게 됩니다.

## 결과 보기

그래서 `m.summary()` 하면 괄호가 비어있는데 그래도 괄호를 무조건 붙여주셔야 돼요.

왜냐하면 함수라서 `m.summary()` 하면 이 분석 결과를 요약을 해 가지고 리포트를 보여줘 이런 얘기입니다.

```python
m.summary()
```
## 결과 해석


뭐 숫자가 되게 많이 나오는데 일단 중요한 숫자는 뭐냐면 여기 복잡하게 있는데 여기 가운데 보시면 **coef**라는 게 있습니다. 여기 숫자 두 개가 제일 중요해요. 나머지는 조금 덜 중요하고 이 숫자가 제일 중요합니다.

이 coef는 뭐냐면 coefficient, 즉 계수(係數)라는 뜻인데 이렇게 읽으시면 됩니다.

그래서 여기 Intercept라고 나오는 거는 우리가 주행거리 `mileage` 0일 때 가격입니다. 중고차 차가 고객한테 인도된 다음에 고객이 그 차를 1km도 안 타고 그냥 그대로 중고차 시장이 내놓은 거죠. 그러면 중고차 가격이 얼마를 받느냐 약간 옛날 데이터고 또 차량이 여기 보면 다 소형차라서 그런 걸 좀 감안하시면 약간 대량 1258.768 이게 만 원 다니니까 한 1258만 원 받는다. 이런 얘기입니다.

그래서 그 다음에 이제 `mileage` 옆에 있는 숫자는 이건 뭐냐면 `mileage`가 1km 늘어나면 가격이 얼마가 빠지나 이런 얘기입니다. 그러면 이게 만원대니니까, 마이너스 0.0052 만 원이면 52원이 되겠죠. `mileage`가 1km 늘어날 때마다 52원씩 빠진다는 얘기예요.

이걸 공식으로 쓰면 이렇게 쓸 수가 있습니다.

$$
\text{price} = 1258.768 - 0.0052 \times \text{mileage}
$$

그래서 이 공식에다가 여러분이 어떤 차에 `mileage`를 대입하시면 K3 아반대 같은 소용급의 국산차인 기준으로는 이런 식으로 중고차 가격이 결정된다. 이런 얘기죠.

그래서 여러분들이 예를 들면 친구랑 놀러 가기로 했어요. 서울에서 부산까지 놀러 가기로 했다. 여러분 차를 소용차를 끌고 한번 놀러 왔다 갔다 했는데 1000km를 뛰었어요. 1000km를 뛰면 중고차 가격이 얼마가 빠지는 겁니까 마이너스 0.005이에다가 1000을 굽하면 마이너스 5.20만 원이죠. 그러면 중고차 가격이 52,000원이 빠지는 겁니다.

친구가 "운전하느라 고생했다. 기름값은 내가 낼게" 하면서 10만원을 줬다. 그러면 친구한테 "중고차 가격이 빠지는 건 생각 안 하냐? 5만원 더 내놔" 이렇게 이 결과를 보여주시면서 이러면, 친구가 다시는 여러분하고 놀러 가려고 안 하겠죠. "독한 놈"이러면서. 

그래서 실제로 여러분이 1000km로 놀러 갔다고 하셔서 정말 중고차 가격이 딱 5만원 빠지겠냐 라고 하면 그렇지는 않겠죠. 기계적으로 그렇게 되진 않는데 대략 경향적으로 그 정도 추세로 빠진다. 이런 거를 우리가 분석을 할 수가 있습니다.

그래서 이 회귀 분석이 보여주는 거는 이 두 가지 숫자가 중요하고요.

그 다음에 이제 표에 보면은 여기 표준오차랑 t 값이라는 게 있는데 요거는 안 보셔도 되는 숫자에요.

### p-value

그 다음에 그 옆에 이제 p-value랑 신뢰구간이라는 게 나오는데 요거를 간단하게만 설명을 드리도록 하겠습니다.

그래서 일단 이제 요 숫자는 왜 나오는 거냐? 요 오른쪽의 숫자는 지금 우리가 1258만원이라든가 0.0052라든가 이거는 우리가 어떤 표본에서 구한 거예요. 표본이라는 거는 우리가 지금 분석에 사용한 데이터 입니다.

근데 우리가 전국에 있는 모든 중고차 시장을 전수조사한 게 아니고 거기에 있는 일부 차량들을 표본으로 뽑아 가지고 관찰을 한 거예요. 그러면 모집단이라는 거는 전수를 말하는 겁니다. 전수는 이만큼 있는데 우리는 그 중에 이만큼의 표본을 관찰을 했어요. 그러면은 우리가 이 제한된 표본에서 관찰한 거를 일반화를 시켜야 되잖아요. 

근데 문제는 표본이라는 거는 이렇게 저렇게 좀 치우친 표본일 수 있단 말이에요. 우리가 하필 중고차 시장에 조사러 간 날 좀 좋은 중고차가 많아 가지고 가격이 좀 비싸게 잡혔을 수도 있고 아니면 하필 우리가 간 날 좀 싼 중고차들이 시장에 많이 나와 있어서 시장에 좀 싸게 나와 있을 수도 있고 여러 가지 이유로 데이터가 이렇게 저렇게 치우칠 수가 있습니다. 그래서 우리가 이제 이 분석 결과를 일반화 하려면 그 제한이 존재하게 되는 거죠.

그래서 여기에 대해서 여러 가지 추론이 필요한데 그 추론을 위해서 아까 봤던 표에 오른쪽에 있는 숫자들이 있는 거예요.

그래서 첫 번째로 나오는 숫자는 p-value 라고 합니다. `p>|t|` 이런 식으로 되어있는데 이걸 p-value 라고 부르는데요. 이 p-value는 뭐냐면 통계적 가설 검정 이라는 걸 하는데 쓰는 숫자에요. 

통계적 가설 검정은 항상 이름 앞에 뭐뭐 ~적 이런 게 붙으면 해석에 주의가 필요합니다. 예를 들면 우리가 뭘 할 때 한국적 한국형 이런 식으로 뭐가 붙으면 약간 좀 뭔가 좀 글로벌한 거랑 다른 거가 이렇게 붙는 거거든요. 
통계적 가설 검정도 일반적인 가설 검정하고 뭐가 좀 다르기 때문에 앞에 통계적 이런 말이 붙은 거예요.

일반적인 가설 검정은 내가 뭔가 하고 싶은 주장이 있어서 내가 뭔가 가설이 있어서 이 가설을 입증하려는 게 일반적인 가설 검정이죠. 통계적 가설 검정은 딱히 입증하려고 하는 생각은 없고 의심을 뭔가 하는 겁니다.

이 통계적 가설 검정을 만든 사람들은 그 되게 의심이 많은 사람들이었어요. 로날드 피셔라든가 이런 사람들이 만든 건데 굉장히 그 의심꾸러기들입니다. 그래서 의심꾸러기들이라 가지고 어떤 생각을 했냐면 아니 중고차 가격하고 주행거리 사이에 아무 관련도 없는데 아무 관련이 없으면 기울기가 0이 돼야 됩니다.

그러니까 주행거리가 길어도 가격이 이만큼이고 주행거리가 짧아도 가격이 이만큼이고 그러면 기울기가 이렇게 평평하게 가겠죠. 이렇게 되면 기울기가 0인데 원래는 선이 이렇게 수평으로 가는데 데이터가 이렇게 있어야 되는데 하필 내가 조사하러 간 날 데이터나 위에 이렇게 살짝 튀었어요. 그럼 직선을 그리면 이렇게 올라가게 나올 수가 있는 거죠. 반대로 밑으로 하나 삭 튀면은 이런 식으로 그럼 선을 이렇게 그려야 되는 것처럼 볼 수 있겠죠.

그러니까 뭐가 실제로는 관련이 없는데 데이터가 살짝 튀어가지고 이게 좀 우연히 관련이 있는 것처럼 나타날 수 있지 않을까 그래서 아까 기울기가 마이너스 0.005이 이렇게 나왔는데 이게 진짜로 뭐가 주행거리가 길어지면 가격이 떨어져서 이렇게 기울기가 나오는 건지 아니면 실제로는 별로 관련이 없는데 그냥 우연히 숫자가 좀 튀어서 나온 게 아닌지 약간 의심을 하는 겁니다.

그래서 통계적 가설 검정은 그 의심을 배제를 하려고 하는 절차예요. 그래서 내가 뭘 주장하고 싶은 게 아니고 반대로 혹시 이런 거 아니야? 약간 마음이 거림칙한데 이거 가지고 이 정도 데이터 가지고 내가 이거 주행거리에 관계가 있다고 생각해도 될까? 의심을 풀기 위해서 존재하는 절차입니다.

그래서 어떻게 하냐면 우리의 우연히 좀 튀을 가능성이 있는 거잖아요. 데이터가. 그 가능성을 p-value라는 형태로 계산을 합니다. 이 p-value라는 좀 약간 희한한 계산이 들어가요. 그래서 이거는 확률도 아니고 뭔가 좀 특이한 수치인데 약간 여기서는 그냥 그런 가능성을 어쨌든 계산을 한 겁니다.

그래서 이 p-value라는 걸 계산을 해가지고 우리가 어떤 컷트라인을 정해요. 컷트라인이 예를 들면 5%다. 그러면 숫자로 표시하면 0.05가 됩니다. 그래서 그 컷트라인보다 미치면 그냥 안심을 하는 거예요.

가능성이 세상에 뭐든지 가능성은 있습니다. 뭐 희한한 별의 별의 가능성은 다 있는데 강성이 너무 낮으면 그냥 너무 낮으니까 그거는 신경 쓰지 말자. 물론 마음속 한 구석의 의심은 있겠지만 그래도 좀 믿고 넘어가는 거예요. 그래서 p-value로가 아주 너무 낮으면 우리가 의심했던 원래 혹시 아무 관련 없는 거 아니야? 그 의심은 좀 접어두는 거죠.

그래서 지금 우리 결과를 보면 p-value로가 지금 다 0.000 0.000 이렇게 되어있죠. p-value로가 작다는 거는 이게 관련이 없는데 그냥 숫자가 좀 튀어가지고 뭔가 기울기가 있는 것처럼 나오는 거는 그거는 아닌 것 같다.

실제로 모집단에 전수조사하기 전에는 정말로 마이너스 0.0052인지 0.0051인지 그거는 모르겠지만 약간 그냥 실제로 0인데 숫자가 이렇게 튀어가지고 이렇게 나오지는 않았을 거다. 그래도 뭐라도 관련은 있을 거다. 이런 거를 우리가 이제 보여주는 게 p-value입니다.

그래서 p-value은 간단히 얘기하면 0.05보다 작으면 일단은 안심하시면 됩니다.

### 신뢰구간

그 다음에 그 옆에 이제 숫자가 2개가 나와요. 제가 방금 뭐라고 얘기했냐면 전수조사를 하기 전에는 마이너스 0.0052인지 뭐 0.0051인지 그거는 장담 못한다 이런 얘기를 했어요. 그래서 이 옆에 나온 숫자는 그럼 뭐냐면 그러면 어느 정도까지 나오겠냐 우리가 모집단에서 정확하게 얼마인지는 모르겠지만 계속 대략 범위는 얘기할 수 있잖아요. 대략 범위를 잡은 게 여기 있는 숫자 2개입니다.

그래서 정확하게 마이너스 0.0052 이라고 장담은 못하겠지만 대충 마이너스 0.006에서 마이너스 0.005 사이에 있을 거 같다, 한 그 정도 될 거 같다 라고 이제 나오는 게 오른쪽에 있는 숫자입니다. 이거를 신뢰구간(confidence interval)이라고 불러요.

여론조사 하면 뭐라고 얘기하냐면 예를 들어서 어떤 사안에 대해서 찬반 조사를 해보니까 전 국민의 60%가 찬성을 합니다. 이렇게 얘기를 한 다음에 마지막에 항상 뉴스에서 뭐라고 하냐면 "이 여론조사는 95%에서 &pm;3.1% 포인트 입니다." 이렇게 얘기를 해요. 끝에 있는 이 &pm;3.1% 포인트라는 게 뭐냐면 이번 여론조사에서 60% 찬성이 나오긴 했는데 실제로는 요거에서 &pm; 3.1 그 여론조사는 56.9%에서 한 63.1% 정도까지도 될 수 있다. 그걸 플러스 마이너스 있다는 건 감안하시라는 얘기입니다.

그러니까 우리의 경우에도 이게 기울기가 마이너스 0.005 위로 나오긴 했는데 일단 그거는 그렇게 나오긴 했는데 실제로는 요거가 조금 더 높을 수도 있고 조금 낮을 수도 있으니까 요거는 감안해라 이렇게 그런 정보를 보여주는 겁니다.

그래서 이게 너무 크지 않으면 뭐 그렇게 차이 많이 안 나는 거니까 일단 믿고 넘어가면 되겠죠.

근데 이게 너무 숫자 범위가 너무 넓다든가 기울기가 너무 커 너무 범위가 너무 넓어, 그러면 어떻게 하시느냐면 조사를 더 많이 해야 됩니다. 요거는 데이터가 많아지면 좁아져요. 그래서 데이터를 너무 범위가 넓거나 이러면 데이터를 좀 많이 늘리셔야 됩니다.

### 신뢰수준

그래서 신뢰구간은 사실 이제 원래는 무한이 넓을 수가 있어요. 왜냐하면 세상에는 별의 별일이 다 있기 때문에 우리가 정말 희한한 데이터를 가지고 왔을 수도 있거든요.

그래서 무한히 넓을 수 있는데 그래서 너무 넓으면 이게 우리가 의사 결정을 할 수 없거든요.

여러분들이 오늘 저녁에 통계랑 파이선이랑 강의가 되느라 너무 힘들어가지고 치킨을 먹으면서 치킨에 맥주 한잔하면서 스트레스를 풀려고 치킨집에 전화를 했습니다. 그래서 치킨집 사장님한테 지금 치킨 시키면 얼마나 걸려요? 하면 사장님이 그 얘기를 듣고 "아니 치킨을 배달하다 보면 사고가 날 수도 있고 그럼 세상에 별의 별일이 있을 수 있는데 내가 그 얼마 걸린지 어떻게 얘기해?" 이런 식으로 얘기하면 여러분이 '지금 무슨 소리야?' 이런 생각이 들겠죠. 근데 그럴 가능성이 없는 건 아니잖아요. 별의 별일이 있지만 그런 되게 희박한 경우는 좀 배제하고 대략 어느 정도냐? 그거를 얘기하는 게 신뢰수준입니다.

그래서 보통 한 95% 정도로 제한을 합니다. 여기서 95%라는 것도 실제로 약간 확률적인 의미의 95%라기보다는 대략 100가지 가능성이 있으면 그 중에 한 5가지는 배제하고 너무 이상한 경우는 배제하고 대략 흔히 있는 경우만 얘기하면 한 이 정도다 이런 느낌이라고 생각을 하시면 될 것 같아요. 정확한 확률적인 의미의 95%는 아닙니다.

그러면 여러분 생각하시기에 아니 왜 95%로 하냐? 100%면 좋은 거 아니에요? 이렇게 생각하실 수 있는데 100%라는 건 별의별 희한한 경우까지 다 가정하는 거니까 우리가 의사 결정을 할 수가 없어요.

예를 들면 제가 이건 인터넷에서 주어온 건데 일본 제1의 프로파일러라는 분이 계시대요.

그래서 그분한테 어떤 미제사건을 여쭤봤는데 그분이 뭐라고 얘기하셨냐면 범인은 아마도 20대에서 30대 또는 40대에서 50대까지도 가능할 것 같고 남성이라고 얘기를 하지만 여성일 가능성도 무시를 못하고 직업은 학생일 수도 있고 회사원일 수도 있고 주부일 수도 있고 또는 무직일 수도 있으며 동부지방에 있을 수도 있고 중부지방에 있을 수도 있고 섬에 있을 수도 있고 해외로 도망갔을 수도 있다 이렇게 얘기를 하시는 그런 인터넷 짤이 돌아다니더라고요. 

그러니까 이제 우리가 모든 경우를 다 고려하면 이 분 말씀이 맞겠죠. 그런데 그런 모든 가능성을 고려하면 우리가 범인을 잡으러 이렇게 어디론가 수사를 해야 되는데 수사를 할 수가 없잖아요

이렇게 얘기를 하면 그러니까 우리가 어떤 의사결정을 할 때는 너무 범위가 넓게 잡아 펴 있으면 뭔가 의사결정을 할 수가 없습니다. 그래서 좀 희박한 경우는 그런 경우에 걸리면 어쩔 수 없어요. 그런 거는 뭐 우리가 항상 모든 걸 다 맞는 결정을 할 수는 없으니까 어느 정도는 가능성을 배제를 하고 봐야 됩니다.

그래서 보통 신뢰구간을 잡을 때 95% 꼭 95%를 잡아야 되는 거 아니에요. 99%를 잡을 때도 있고 그런데 그래도 100%로 하진 않는다. 보통 95%나 99% 이렇게 좀 희박한 경우는 배제를 하는 거죠.

그런데 이제 물론 이제 우리가 좀 더 방어적일 경우가 있고 그럴 때는 좀 더 희박한 경우까지 고려를 하고 99% 이렇게 좀 넓게 잡고 좀 더 일반적으로 교과서적으로는 한 95% 이 정도로 보통 잡습니다. 그래서 약간 특이한 케이스 이런 거는 좀 배제하고 생각한다 이런 거죠.

그래서 이 신뢰구간이 보여주는 거는 우리가 이제 추정치가 플러스 마이너스가 좀 있을 수 있으니까 그런 게 어느 정도 될지를 보여준다. 이런 정보라고 생각을 하시면 되겠습니다.

## 예측


그럼 이걸 이용해서 우리가 예측을 할 수 있어요. 그래서 중고차가 10,000 Km 띄는 중고차가 있고 20,000 Km 띄는 중고차가 있다. 그럼 이거를 아까 산식에다 대입을 해보면은 여기 공식에 대입을 하면 그 예상 가격이 나오겠죠.

엑셀을 하나 여셔가지고 새 파일을 하나 만들어요. 제일 상단에 `mileage` 이렇게 써줍니다. 그다음에 이제 10,000 Km 20,000 Km 차가 여러 대 있으면 예를 들면 여러분이 중고차 비즈니스를 하신다. 그러면 중고차가 여러 대 들어왔겠죠. 그럼 중고차 그 데이터를 쭉 만들어주시면 돼요.

우리는 이제 다른 변수는 필요 없습니다. 왜냐하면 우리 산식에는 `mileage`만 들어가면 되니까 다른 변수 넣는 건 이제 좀 있다 얘기 드리고 `mileage` 이렇게 한 다음에 쭉 써주시면 돼요.

그래서 이거를 `new_car.xlsx` 라고 저장을 해줄게요. 그 다음에 이거를 이제 또 콜랩에다가 올려주는 거죠.여기 `car.xlsx`가 있고 `new_car.xlsx`가 있고 이렇게 되겠죠.

불러오기

```python
new_df = pd.read_excel('new_car.xlsx')
```

모형에 입력하여 예측

```python
m.predict(new_df)
```
이렇게 하면 이제 숫자가 두 개가 나오죠.

1260만원, 1154만원 뭐냐면 우리가 넣어준 만 이만을 아까 분석한 산식에다가 대입을 해 가지고 계산을 해줍니다.

손으로 계산하면 되지 않나요? 할 수 있지만 차가 100만 대가 있다. 그럼 손으로 다 일일이 계산할 수 없잖아요. 그럼 100만 대 데이터를 산식에 넣으면 자동으로 모든 차의 가격이 산출돼서 나오는 거죠.

그럼 만약에 우리가 이제 이걸 여러 가지로 활용할 수 있는데 예를 들면 여러분이 HR 업무를 한다. 그럼 이번에 지원자가 우리 회사에 1000명이 들어왔는데 예를 들면 통계 분석을 해 가지고 토익 점수랑 학점이랑 이런 걸 반영하면 이 사람을 뽑으면 우리가 인사 데이터가 있잖아요. 그럼 이 사람이 학점은 이렇고 토익은 이렇고 뭐는 이렇고 이런 사람은 회사에 들어오면 우리 인사 평가 내부 기준으로 5점만점에 4.5점을 받는다. 이런 사람은 5점 기준으로 3.5점을 받는다. 그러면 신입사원 지원자들 데이터를 여기 넣고 산식에 넣으면 이 사람은 대략 한 요 정도 이런 사람이면 입사하면 한 요 정도의 인사 평가를 받겠구나. 그럼 이제 거기에다가 이제 약간 면접이나 이런 걸 통해서 정성적인 요소를 좀 넣으면 우리가 좀 더 쉽게 채용을 할 수 있겠죠.

물론 딱 맞느냐 하면 그렇지 않습니다. 사람에게 변수가 많으니까 그것만 가지고 예상할 수는 없지만 그래도 한 가지 참고 기준이 되겠죠.

그래서 여기 `predict`라는 함수는 우리 M은 분석 결과가 들어있는 거고 분석 결과를 이용을 해서 예측을 해주는데 말이 예측이지만 아까 우리가 만든 산식에다가 요 `new_df`에 있는 데이터를 대입을 해서 계산을 해주는 거예요.

부품의 수요 예측을 하고 싶으시다. 그러면 우리가 수요에 영향을 주는 변수들이 여러 가지가 있잖아요. 그럼 그걸 독립변수로 넣고 종속변수를 수요로 해가지고 대입을 하면은 요고 요고 요고 대입하면은 수요가 한 요 정도 예상된다. 이런 식으로 이제 산식을 만들어서 뽑으면 대략적인 수치가 나오겠죠. 물론 여기서 플러스 마이너스가 있겠지만 그런 거는 여러분들 업무 경험으로 조절을 해 주시면 될 것 같고 실제로 굉장히 많은 분야에서 이런 식으로 예측을 하게 됩니다.


## R 제곱


이렇게 예측을 하면은 요제 예측이 얼마나 잘 맞냐, 맞을 수도 있고 예측이라는 게 맞을 수도 있고 틀릴 수도 있는데 얼마나 잘 맞냐, 요거를 이제 우리가 수치화시켜서 얘기할 필요가 있는데 그걸 R제곱이라고 해요.

우리 분석 결과에도 보시면 오른쪽 맨 상단에 R Squared라고 나오는 숫자가 있습니다.

여기 0.457이라고 나오죠. 이게 이제 곱하기 100을 하면은 45.7%인데 이게 이제 얼마나 예측이 정확하냐를 나타내는 수치입니다.

그러니까 이게 100%면 오차가 하나도 없는 거예요. 이게 100%면 이 산식에서 나온 가격이 그대로 거래되는 그런 상황이면 이게 100%입니다.

그러면 45.7%가 어떤 의미인지 설명 드려보겠습니다.

예를 들면 여기 중부차 데이터를 보면은 가격이 한 싼 거는 100만 원 200만 원하고 비싼 거는 뭐 1800만 원 1900만 원 합니다. 그러면 가격이 이제 플러스 마이너스로 한 900만 원 이 정도 플러스 마이너스가 있는 셈입니다.

우리가 이 차가 주행 거리가 얼마지 를 알면은 주행 거리가 얼마냐면 가격이 한 이만큼 되겠구나, 이렇게 추정을 하면 거기서도 플러스 마이너스가 있어요. 거기서도 플러스 마이너스가 있는데 그 범위가 플러스 마이너스 900은 아니고 한 45% 정도로 확 줄어든다는 거죠. 플러스 마이너스 한 400만 원 정도 되는 거죠.

그러니까 우리가 중고차를 예를 들어서 만 키로 정도 뛰는 중고차다. 그러면은 우리 가격 공식에 산정된 게 1200만 원인데 정말 딱 이런 단 틀리고 1200만 원이겠냐, 하면 그렇진 않아요. 그거보다 플러스 마이너스가 있는데 플러스 마이너스 한 400, 그러니까 한 1600에서 한 800 사이 정도 가격이 나올 수 있는 거죠. 그 정도의 정확도가 여기 R제곱이 0.45, 45%라는 거에 의미가 됩니다.

R제곱이 0이다. 그럼 무슨 얘기냐면 원래 우리가 한 플러스 마이너스 900만 원 정도가 오차가 있는 건데 R제곱이 0이면은 예측을 하고 나서도 여전히 플러스 마이너스가 900만 원 있는 겁니다. 아무 것도 예측에 한 게 없는 거죠.

## 연식으로 분석하기

그래서 R제곱은 높으면 높을수록 우리 예측이 정확하게 되는 건데 그래서 우리가 여기서 이제 응용을 한번 해보면 좋아요.

주행거리는 `mileage`로 분석을 하면은 1km의 52원씩 가격이 떨어지고 그다음에 그게 한 45% 정도의 정확도가 있는 거죠.

우리 아까 데이터해 보면은 연식이 있거든요. 그럼 연식은 얼마나 영향을 미칠까? 어떻게 하냐면 여기 `mileage`를 `year`로 바꿔서 돌려볼게요.


```python
m = ols("price ~ mileage", data = df).fit()
m.summary()
```

그래서 돌리면 돌리면 어떻게 나오냐면 여기 일단 R제곱을 보시면 R제곱이 0.687이에요. 68.7% 정도의 정확도가 있는 거죠. 그럼 아까는 45%였잖아요. 훨씬 정확한 거죠.

즉 우리가 예를 들면 여러분이 중고차를 사야 되는데 딱 하나만 알 수 있다. 그러면 주행거리냐 연식이냐 연식이 훨씬 더 정확한 정보를 준다. 연식을 알면 착값을 더 오차가 적게 짐작을 할 수가 있어요.

그래서 연식이 훨씬 더 정확한 정보를 주고 그러면 연식에 대해서 이제 어떻게 되느냐. 여기 절편은 사실 굉장히 숫자가 작은데 왜냐하면 절편은 항상 0일 때가 기준이에요. 서기 0년이 기준인데 이때는 서기 0년식 아반때는 없고, 단지 직선을 쭉 그어서 0까지 그으면 얼마에 닿냐, 이런 얘기죠.

기울기가 지금 106.474 이렇게 나오는데 이 얘기는 뭐냐면 지금 연식이 2010, 2011, 2010이 이렇게 연식이 올라갈수록 더 새 차잖아요. 2010년식보다는 2011년식이 더 새 차고 2011년식보다는 2012년식이 더 새 차죠. 그렇게 1년 1년 새 차가 되면 가격이 어떻게 올라가냐면 160만 원씩 올라간다. 이런 이야기입니다.
