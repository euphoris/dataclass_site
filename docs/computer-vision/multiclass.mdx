# 이미지 다항 분류

## 다항 분류 모형
```python
model = keras.models.Sequential([
    keras.layers.Rescaling(1/255),
    keras.layers.Flatten(),
    keras.layers.Dense(16, activation='relu'),
    keras.layers.Dense(10, activation='softmax')
])
model.compile(optimizer=keras.optimizers.SGD(
    learning_rate=0.001), 
    loss='sparse_categorical_crossentropy', 
    metrics=['accuracy'])
model.fit(x_train, y_train, epochs=5, batch_size=32)
```

## 예측
*  확률 계산
```python
y_prob = model.predict(x_test)
y_prob.shape
```

## 소프트맥스 함수 softmax
*   이항분류에서는 로지스틱 함수로 -∞ ~ +∞의 값을 0~1 범위로 변환
*   다항 분류에서는 소프트맥스 함수를 사용
*   여러 개의 입력을 받아, 같은 개수를 출력
*   모든 출력의 합은 1, 각 출력의 범위는 0~1
```python
keras.activations.softmax(np.array([-1, 0.5, 2.0])) == [0.039, 0.175, 0.796]
```

-   시그모이드는 소프트맥스의 특수한 경우
    -   둘 중에 하나로 예측할 때: sigmoid
    -   셋 이상 중에 하나로 예측할 때: softmax
```python
x = 1.0
keras.activations.sigmoid(x)
keras.activations.softmax(np.array([0.0, 1.0]))
```

$$
y_j = \frac{e^{x_j}}{\sum_{i} e^{x_i}}
$$

## 소프트맥스 함수가 없는 모형
```python
model = keras.models.Sequential([
    keras.layers.Rescaling(1/255),
    keras.layers.Flatten(),
    keras.layers.Dense(16, activation='relu'),
    keras.layers.Dense(10) # activation='softmax'가 없음
])
model.compile(optimizer=keras.optimizers.SGD(learning_rate=0.001), 
              loss=keras.losses.SparseCategoricalCrossentropy(from_logits=True), metrics=['accuracy'])
model.fit(x_train, y_train, epochs=1, batch_size=32)
```

로짓 계산

```python
logits = model.predict(x_test)
logits.shape  # 10000, 10
logits[0] # 0번째 샘플의 로짓
keras.activations.softmax(logits[0]) # 0번째 샘플의 확률
```

## 퀴즈


import { QuizComponent } from "@/components/QuizComponent";

<QuizComponent quizId="multiclass" quizItems={
    [
    {
        "item_type": "radio",
        "question": "소프트맥스 함수에 입력하면 확률이 되는 값을 무엇이라고 합니까?",
        "options": [
            "logit",
            "odds",
            "likelihood",
            "score"
        ],
        "hint": "신경망의 출력층에서 계산된, 정규화되지 않은 점수입니다.",
        "solution": "logit"
    },
    {
        "item_type": "radio",
        "question": "1, 2, 3을 소프트맥스 함수에 입력했을 때 3에 해당하는 확률은 얼마입니까?",
        "options": [
            "약 9%",
            "약 24%",
            "약 67%",
            "약 90%"
        ],
        "hint": "keras.activations.softmax(np.array([1.0,2.0,3.0]))",
        "solution": "약 67%"
    },
    {
        "item_type": "radio",
        "question": "출력이 1개이고 시그모이드를 활성화 함수로 사용하는 이항 분류 모델을 소프트맥스 함수를 활성화 함수로 사용하는 다항 분류 모델로 바꾸려면 출력의 개수를 몇 개로 해야합니까?",
        "options": [
            "1개",
            "2개",
            "3개"
        ],
        "hint": "이항 분류는 'A인가, 아닌가'의 문제이지만, 소프트맥스를 사용하면 'A인가, B인가'의 문제로 바뀝니다.",
        "solution": "2개"
    }
]
} />


## Q&A
<iframe src="https://tally.so/embed/wbOOKg?alignLeft=1&hideTitle=1&transparentBackground=1&dynamicHeight=0" loading="lazy" width="100%" height="274" frameborder="0" marginheight="0" marginwidth="0" title="Q&A"></iframe>