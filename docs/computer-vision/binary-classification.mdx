# 이항 분류

## MNIST
*   1998년 미국 국립표준기술연구소 National Institute of Standards and Technology에서 개발
*   가로 28 × 세로 28 크기의 손으로 쓴 숫자(0~9) 흑백 이미지
*   6만개의 훈련용 이미지와 1만개의 테스트용 이미지로 구성
*   가장 유명한 컴퓨터 비전 연구용 데이터

## 데이터 다운로드
```python
(x_train, y_train), (x_test, y_test) = keras.datasets.mnist.load_data()
```

- `x_train`: 훈련용 이미지
- `y_train`: 훈련용 이미지의 클래스(0, 1, 2, …, 9)
- `x_test`: 테스트용 이미지
- `y_test`: 테스트용 이미지의 클래스 (0, 1, 2, …, 9)


## 데이터 보기
데이터 크기 보기 (가로 28, 세로 28)
```python
x_train[0].shape
```

이미지로 보기
```python
from PIL import Image
Image.fromarray(x_train[0])
```

클래스 보기
```python
y_train[0]

```

## 이항 분류와 다항 분류
*   다항 분류: 셋 이상 중에 하나로 분류하는 것(MNIST는 10가지로 분류하는 다항 분류 데이터셋)
*   이항 분류: 둘 중에 하나로 분류하는 것
    *   이항 분류를 위해 0과 1만 뽑음

```python
import numpy as np
def filter_binary(x, y, neg_cls, pos_cls):
    cond = (y == neg_cls) | (y == pos_cls)
    x_bin = x[cond]
    y_bin = np.where(y[cond] == neg_cls, 0, 1)
    return x_bin, y_bin
x_train_binary, y_train_binary = filter_binary(x_train, y_train, 0, 1)
```
*   이항 분류를 할 때는 항상 레이블이 0과 1이어야 함
    *   3과 4를 뽑으면 3 → 0, 4 → 1로 레이블을 바꿔야


## 모형 정의
```python
model = keras.models.Sequential(  # 딥러닝 모형의 구성 요소를 순서대로 정의
    [
        keras.layers.Rescaling(1/255), #  입력 값의 범위를 0~255에서 0.0 ~ 1.0으로
        keras.layers.Flatten(), #  이미지 평탄화
        keras.layers.Dense(1, activation='sigmoid') # 이미지마다 1개의 출력
    ]
)
```

## 평탄화

## Dense
*   선형 모형 `y = wx + b` 형태의 레이어
*   모든 입력에 대해 가중치 w를 곱하고, 편향 b를 더함
*   Fully Connected라고도 함
*   -∞ ~ +∞ 를 출력
*   이항 분류 문제이므로 0 또는 1로 출력을 해야 함 → 활성화 함수(activation function)


## 시그모이드 함수 sigmoid function
*   출력층에서 0~1 사이의 출력을 표현하기 위해 사용
*   S자(sigma)를 닮은(oid)이라는 뜻
*   계단 함수는 미분불가능하므로 점진적 학습이 어려움
*   0~1 사이에서 매끄럽게 변하는 함수
*   출력은 확률로 해석 (예: 0.8 → 1일 확률이 80%)
*   통계에서는 로지스틱(logistic) 함수라고 부름

$$
\sigma(z) = \frac{1}{1 + e^{-z}}
$$    


## 퀴즈

import { QuizComponent } from "@/components/QuizComponent";

<QuizComponent quizId="binary-classification" quizItems={
[
    {
        "item_type": "radio",
        "question": "MNIST 손글씨 숫자 데이터셋을 분류하는 문제는 어떤 종류의 분류 문제에 해당합니까?",
        "options": [
            "이항 분류",
            "다항 분류",
            "회귀",
            "군집"
        ],
        "hint": "MNIST 데이터셋은 0부터 9까지 총 10개의 숫자 클래스를 가지고 있습니다.",
        "solution": "다항 분류"
    },
    {
        "item_type": "number",
        "question": "MNIST에서 이미지 한 장을 이루는 점의 개수는 몇 개입니까?",
        "options": [],
        "hint": "MNIST 이미지는 가로 28개, 세로 28개의 픽셀(점)로 구성된 흑백 이미지입니다.",
        "solution": "784"
    },
    {
        "item_type": "radio",
        "question": "이항 분류 모형의 출력은 몇 개인가요?",
        "options": [
            "1",
            "2",
            "3"
        ],
        "hint": "두 개의 클래스 중 하나일 확률을 출력합니다.",
        "solution": "1"
    },

    {
        "item_type": "checkbox",
        "question": "이항 분류 문제에서 일반적으로 사용되는 레이블을 고르세요",
        "options": [
            "0",
            "1",
            "2",
            "3",
        ],
        "hint": "시그모이드 함수는 0에서 1 사이의 값을 출력합니다.",
        "solution": ["0", "1"]
    },
    {
        "item_type": "radio",
        "question": "케라스(Keras)에서 Flatten 레이어의 역할로 올바른 것은 무엇입니까?",
        "options": [
            "데이터의 특징을 추출한다",
            "다차원 입력을 1차원으로 평탄화한다",
            "모델의 활성화 함수를 결정한다",
            "분류 결과를 출력한다"
        ],
        "hint": "이미지 데이터를 신경망에 입력하기 전에 1차원 벡터로 변환합니다.",
        "solution": "다차원 입력을 1차원으로 평탄화한다"
    },
    {
        "item_type": "radio",
        "question": "케라스(Keras)에서 Dense 레이어에 대한 설명으로 올바른 것은 무엇입니까?",
        "options": [
            "이미지의 공간적 특징을 학습하는데 특화되어 있다",
            "입력과 출력이 완전히 연결된 가장 기본적인 신경망 층이다",
            "모델의 과적합을 방지하는 역할을 한다",
            "입력 데이터의 차원을 축소한다"
        ],
        "hint": "완전 연결 계층(Fully-Connected Layer)이라고도 불립니다.",
        "solution": "입력과 출력이 완전히 연결된 가장 기본적인 신경망 층이다"
    },
    
    {
        "item_type": "radio",
        "question": "시그모이드 함수의 출력이 0.4라면 입력된 이미지가 0번 카테고리일 확률은?",
        "options": [
            "20%",
            "40%",
            "60%",
            "80%"
        ],
        "hint": "시그모이드 함수의 출력값은 1번 카테고리에 속할 확률을 의미하며, 두 카테고리의 확률의 합은 1(100%)입니다.",
        "solution": "60%"
    },
]
} />


## Q&A
<iframe src="https://tally.so/embed/wbOOKg?alignLeft=1&hideTitle=1&transparentBackground=1&dynamicHeight=0" loading="lazy" width="100%" height="274" frameborder="0" marginheight="0" marginwidth="0" title="Q&A"></iframe>