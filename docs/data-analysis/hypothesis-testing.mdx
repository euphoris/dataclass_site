# 통계적 가설검정

## 두 집단의 평균 비교

두 집단의 평균을 비교하려는 경우

$\bar{X}_1 - \bar{X}_2$의 신뢰구간을 계산($\bar{X}_1$: 대조군 평균, $\bar{X}_2$: 실험군 평균)

```python
avante = df.query('model == "Avante"') # df의 model이 Avante인 건
k3 = df.query('model == "K3"') # df의 model이 K3인 건 
pg.ttest(avante.price, k3.price, confidence=0.95) # 두 집단의 평균 차이의 신뢰구간
```

Avante 집단이 K3 집단에 비해 평균 가격이 -152 ~ -8만원 (→ 평균이 더 낮음) 

## 통계적 가설 검정

- 일반적으로 평균 차이를 비교할 때는 두 집단의 평균이 다르다는 가설을 주장을 하려고 함
- 이를 위해 일단 "두 집단의 평균이 같다($\bar{X}_1 - \bar{X}_2 = 0$)"이라는 "귀무 가설"을 세움
    - 귀(歸: 돌아가다), 무(無: 없음) → 무로 돌아가다, 즉 없어질 가설(nullify: 무효화하다, 취소하다)
- 귀무가설을 기각함으로써 원래 주장하고자 하던 가설(대립가설)을 채택
- 이러한 절차를 "통계적 가설검정"이라 함
    - 주장하고자 하는 가설을 세워서 입증하는 방식이 아님에 주의
- 귀무가설을 기각하지 못하더라도 채택하지는 않음
    - 평균 차이가 정확히 0이 아니므로, 다를 가능성도 있기 때문

## 유의수준 (Significance Level, α)

- 귀무가설이 참이라도, 표집 오차에 의해 우연히 차이가 있는 것처럼 관찰될 수 있음
    - 예: 동일한 주사위 10개 vs. 10개를 굴려도 두 가지의 평균에서는 차이가 남
    - 예: 동일한 제품 10개 vs. 10개를 만족도 조사해도 두 가지의 평균에서는 차이가 남
- 통상적으로 있을 수 있는 수준의 차이를 벗어나면 차이가 있는 것으로 봄
- 이를 위해 극단적인 가능성의 범위를 유의수준으로 지정(보통 5%)
- 관찰된 차이가 
    - 95%의 경우 있을 수 있는 범위의 차이라면 → 귀무가설 기각 X
    - 5%의 극단적인 범위의 차이라면 → 귀무가설 기각 O
- 유의수준의 절대적인 기준은 없음

## p-value

- 관찰된 차이를 유의수준과 비교하기 위해 변환한 수치
- p-value < 유의수준: 귀무가설 기각
- p-value > 유의수준: 귀무가설 기각 X
- p-value에 영향을 주는 요소
    - 귀무가설과 통계량의 차이
    - 표본의 크기
    - 모집단의 변산성


## 신뢰구간과 p-value에 영향을 주는 요소 비교

- 표본의 크기와 모집단의 변산성은 동일
- 신뢰수준 vs. 유의수준
    - 신뢰구간은 신뢰수준에 따라 달라짐
    - p-value는 유의수준에 영향을 받지 않음 → 계산 후에 유의수준과 비교하는 값
- 귀무가설과 통계량의 차이
    - p-value는 둘 사이의 차이가 크면 작아짐
    - 신뢰구간은 모수에 대한 가설이 없음 → 그 자체가 모수에 대한 구간 추정

## 표본의 크기

- 표본의 크기가 커지면
    - 신뢰구간 작아짐 (같은 귀무가설이라도 신뢰구간에 배제되기 쉬움)
    - p-value는 작아짐 → 귀무가설 기각 쉬워짐 
    - 통계적으로 유의한 차이를 발견하기 쉬움
- 표본이 작아지면 반대

표본 크기를 50개로 줄이면 통계적으로 유의하지 않게 됨
```python
avs = avante.sample(50, random_state=1234)
k3s = k3.sample(50, random_state=1234)
pg.ttest(avs, k3s)
```

## 통계적 유의함 (statistical significance)

- 통계적 가설검정에서 귀무가설을 기각하는 경우 "통계적으로 유의하다"라고 함
- 동일한 관계의 변수라도 표본이 크면 p-value가 작아지고, 통계적으로 유의하게 됨
    - 어떠한 관계가 있다고 주장하기에 표본의 크기가 충분하다는 것으로 이해할 수 있음
- 통계적 유의함 ≠ 현실적 유의함
    - 통계적 유의함은 표본의 크기에 따라 달라지므로, 반드시 현실적으로 유의미한 것은 아님
    - 현실적 유의미함은 주관적 가치 판단의 결과
    - 예: 환자의 수명을 평균적으로 하루 연장 시켜주는 치료제 (통계적으로 유의함. 단, 가격 10억원)



## 퀴즈

<iframe src="https://tally.so/embed/mYvj9J?alignLeft=1&hideTitle=1&transparentBackground=1&dynamicHeight=1" loading="lazy" width="100%" height="2000" frameborder="0" marginheight="0" marginwidth="0" title="[통계] 가설검정 (1)"></iframe>