
# PYTHON과 SQL

## Python을 이용하면 가능한 작업

* **SQL의 한계**: DB에서 데이터를 조회하는 것에 그침 
* **Python의 확장성**:
    * **DB 연동**: DB에서 SQL을 실행 가능 
    * **외부 데이터 호출**: 금융감독원, 한국은행 등 외부 기관 API(웹)에서 최신 환율, 금리, 주가 정보 수집 
    * **복잡한 데이터 처리**: 통계 분석 및 머신러닝 수행 
    * **파일 처리**: 엑셀, 파워포인트 등 오피스 파일 연동 
    * **자동화**: 반복 작업 수행 및 데이터 시각화 
* **활용 예시**: 여러 SQL 질의 결과를 조합하여 그래프로 시각화하고, 이를 파워포인트 보고서로 작성하여 관계자들에게 이메일로 자동 발송 

## 데이터베이스 접속 (Oracle)

* **라이브러리 설치**: Oracle DB 접근을 위한 `oracledb` 라이브러리 설치 (`!`는 쉘 명령어 실행) 
```sh
!pip install oracledb
````

* **접속 설정 및 연결**: 

```python
import oracledb

un = "c##user"               # 사용자 이름
pw = '1234'                  # 비밀번호
cs = "localhost:1521/xe"     # 접속 문자열 (서버:포트/서비스이름)

# 접속 객체 생성
connection = oracledb.connect(user=un, password=pw, dsn=cs)
```

## Pandas 활용

* **Pandas란?**: Python에서 표(Table) 형태의 데이터를 다루는 라이브러리 
* **SQL 결과 변환**: SQL 실행 결과를 읽어서 Pandas의 데이터프레임(표) 형태로 변환 
```python
import pandas as pd
company = pd.read_sql("SELECT COMPANY_NM, CEO_NM FROM TB_COMPANY_MASTER", con=connection)
```
* **엑셀 파일 처리**: 
    * **저장하기**: `to_excel` 함수 사용. `index=False`는 왼쪽의 행 번호를 생략한다는 의미
```python
company.to_excel('회사목록.xlsx', index=False)
```
* **불러오기**: `read_excel` 함수 사용
```python
company2 = pd.read_excel('회사목록.xlsx')
```


## 퀴즈

import { QuizComponent } from "@/components/QuizComponent";

<QuizComponent quizId="python-sql" quizItems={
[
  {
    "item_type": "radio",
    "question": "Python에서 Oracle 데이터베이스에 접속하기 위해 `!pip install`로 설치해야 하는 라이브러리의 이름은 무엇인가요?",
    "options": [
      "oracledb",
      "pandas",
      "py-oracle",
      "oracle-connector"
    ],
    "hint": "교안의 첫 번째 코드 블록을 확인하세요.",
    "solution": "oracledb"
  },
  {
    "item_type": "radio",
    "question": "Python에서 표(테이블) 형태의 데이터를 다루는 데 사용되며, 교안에서 `pd`라는 별칭으로 임포트된 라이브러리는 무엇인가요?",
    "options": [
      "oracledb",
      "numpy",
      "pandas",
      "matplotlib"
    ],
    "hint": "SQL 실행 결과를 표 형태로 변환하는 데 사용되었습니다.",
    "solution": "pandas"
  },
  {
    "item_type": "radio",
    "question": "SQL 쿼리 실행 결과를 한 번에 pandas DataFrame(표) 객체로 읽어오는 함수는 무엇인가요?",
    "options": [
      "pd.read_sql()",
      "pd.read_excel()",
      "pd.to_sql()",
      "oracledb.to_pandas()"
    ],
    "hint": "`company = pd.read_sql(...)` 코드를 참고하세요.",
    "solution": "pd.read_sql()"
  },
  {
    "item_type": "radio",
    "question": "pandas에서 엑셀 파일을 읽어오는 함수는 무엇인가요?",
    "options": [
        "pd.read_excel()",
        "pd.read_sql()",
        "pd.to_excel()",
        "pd.load_excel()"
    ],
    "hint": "`company2 = pd.read_excel('회사목록.xlsx')` 코드를 참고하세요.",
    "solution": "pd.read_excel()"
  },
  {
    "item_type": "radio",
    "question": "`company.to_excel('회사목록.xlsx', index=False)` 코드에서 `index=False` 옵션의 의미로 올바른 것은 무엇인가요?",
    "options": [
      "DataFrame의 행 번호(인덱스)를 엑셀 파일에 포함하지 않는다.",
      "엑셀 파일의 첫 번째 시트를 사용하지 않는다.",
      "파일 저장을 실패(False) 처리한다.",
      "데이터의 순서(index)를 무시하고 저장한다."
    ],
    "hint": "교안에서 '왼쪽의 행 번호'에 대해 설명한 부분을 참고하세요.",
    "solution": "DataFrame의 행 번호(인덱스)를 엑셀 파일에 포함하지 않는다."
  }
]
} />


## Q&A
<iframe src="https://tally.so/embed/wbOOKg?alignLeft=1&hideTitle=1&transparentBackground=1&dynamicHeight=0" loading="lazy" width="100%" height="274" frameborder="0" marginheight="0" marginwidth="0" title="Q&A"></iframe>